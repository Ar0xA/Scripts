#!/usr/bin/python
# Search the CVE service offered by CircLU (https://www.circl.lu/services/cve-search/)

import requests
import argparse
import sys


def search_api(_cve):
    """HELP"""
    print "Searching: " + _cve
    SEARCHURL = "http://cve.circl.lu/api/cve/" + _cve
    r = requests.get(SEARCHURL)
    print "DGB " + str(r.status_code)
    if r.status_code != 200:
        sys.exit("Something has gone horribly wrong.")
    else:
        print "DBG: Continuing"

    print r.text


def __main__():
    """Get this party started"""
    parser = argparse.ArgumentParser(description='DESCRIPTION HERE')
    parser.add_argument('--cve', '-c', dest='cve', help='Search for this CVE')
    parser.add_argument('--summary', '-s', dest='summary', action="store_true", help='Just show the summary')
    parser.add_argument('--version', '-v', action='version', version='%(prog)s 0.1')
    args = parser.parse_args()
    _cve = args.cve
    _summary = args.summary

    if not args.cve:
        sys.exit(parser.print_help())
    else:
        search_api(_cve)


if __name__ == '__main__':
    __main__()

